---
layout: base
category: 03_Languages
breadcrumb: Languages
parent_url:
nav_title: Node.js
nav_priority: 30
---
= Node.js Overview

[[top]]
[float]
= Node.js Application Hosting
[.lead]
OpenShift provides a trusted platform for link:#build[building], link:#launch[hosting], and link:#scale[scaling] Node.js applications using proven, open source technologies. Want to run link:https://www.openshift.com/quickstarts/ghost-with-mysql-on-openshift[a Ghost blog backed by MySQL]? Or, maybe you're looking for link:#launch[Express and MongoDB]? link:https://www.openshift.com/blogs/run-your-nodejs-projects-on-openshift-in-two-simple-steps[Scale your solutions on an open source cloud by adapting your code to take advantage of OpenShift's] link:https://www.openshift.com/developers/technologies[`nodejs-0.10` web runtime cartridge].

Node.js relies on Chrome's V8 engine for a fast and reliable Javascript runtime.  It's event-driven, non-blocking I/O model is lightweight and efficient - a perfect choice for link:https://www.openshift.com/blogs/10-reasons-openshift-is-the-best-place-to-host-your-nodejs-app[highly-concurrent, real-time applications].

[float]
image::nodejs-logo.png[Node.js logo]

link:#launch[Create your first Node.js application] +
link:#structure[Node.js project structure] +
link:#run[Local Development] +
link:#env-vars[Environment Variables] 

[[launch]]
== Server-Side JavaScript On-Demand, with the Nodejs Cartridge
The `rhc` command-line tool makes it easy to provision new application environments.  

Launch a new application ("myapp") using the `nodejs-0.10` web runtime cartridge:
[source]
--
$ rhc app create myapp nodejs-0.10
--

OpenShift's default platform features include automatic DNS setup, SSH services, and a git server (for publishing changes). The resulting output should contain a live URL where your application will be available:

[source]
--
http://MyApp-MyNamespace.rhcloud.com/
--

OpenShift also provides link:https://www.openshift.com/blogs/launching-applications-with-openshifts-web-based-workflow[browser-based workflows for launching new hosted environments right from the Web].

Running `rhc help app create` provides an excellent reference of optional flags.  For example, the `--from-code` argument makes it easy to deploy existing projects, link:https://www.openshift.com/blogs/run-your-nodejs-projects-on-openshift-in-two-simple-steps[as long as they've been adapted to run on OpenShift]. 

This command creates a new horizontally scalable "parks" application from an existing project repo, using the `nodejs-1.0` and `postgresql-9.2` cartridges:
[source]
--
$ rhc app create parks nodejs-0.10 postgresql-9.2 -s --from-code=https://github.com/ryanj/restify-postGIS.git
--

By default, the `rhc app create` command will also attempt to create a local git repository (for development purposes).  This repo will contain a `git remote` address that can be used to push updates to your site.

After creating your app, link:/en/managing-modifying-applications.html[try publishing an update with `git push`].

link:#top[Back to Top]

[[structure]]
== Node.js Project Structure
Nodejs application should incorporate the following project structure:

[source]
----
server.js                Your main application script 
package.json             Npm package descriptor 
node_modules/            Locally installed module dependencies
.openshift/              Optional, OpenShift-specific files:
    action_hooks/        Custom build scripts, or "Action Hooks"
    markers/             Optional marker flags
----

==== `server.js`
By default, OpenShift and npm are both designed to look for a file named "`server.js`" in order to launch your app.  You can specify an alternative filename in your project's `package.json` file link:https://www.openshift.com/blogs/run-your-nodejs-projects-on-openshift-in-two-simple-steps#package_json[includes accurate information on how to start your project].

You'll need to link:https://www.openshift.com/blogs/run-your-nodejs-projects-on-openshift-in-two-simple-steps#env_vars[include a small check to test for the presence of environment variables] that are commonly link:#env-vars[published by the `nodejs` cartridge]:

[source,javascript]
----
var server_port = process.env.OPENSHIFT_NODEJS_PORT || 8080
var server_ip_address = process.env.OPENSHIFT_NODEJS_IP || '127.0.0.1'
 
server.listen(server_port, server_ip_address, function () {
  console.log( "Listening on " + server_ip_address + ", server_port " + port )
});
----

The above code provides sensible default values that will allow the application to run in local development environments, while taking advantage of link:#env-vars[OpenShift-provided configuration details when they are available].

==== `package.json`
Every nodejs application should include a `package.json` file to document the project's link:https://www.openshift.com/blogs/run-your-nodejs-projects-on-openshift-in-two-simple-steps#package_json[init process] and list of dependencies.  

You can specify an alternative server init file by updating your `package.json` file's link:https://www.npmjs.org/doc/misc/npm-scripts.html#DEFAULT-VALUES[`scripts.start`] and link:https://www.npmjs.org/doc/json.html#main[`main`] fields for information on how to start your project:

[source,json]
----
"scripts": {
  "start": "supervisor server.js"
},
"main": "server.js"
----

Check the link:#markers[Markers] section for specifics on how OpenShift uses this information.

[[node_modules]]
==== `node_modules`

This optional folder can be generated automatically during your project's build process, but link:http://www.futurealoof.com/posts/nodemodules-in-git.html[it's generally considered a best-practice to keep this folder's contents under version control].

This is also a resonable place to store custom modules.

==== `deplist.txt`
This file was previously used to document an application's dependency list on OpenShift.  You should be using `package.json` instead.

[[build]]
== The OpenShift Build process
OpenShift will automatically install any package dependencies that are described in your `package.json` file.

=== Action Hooks
link:http://openshift.github.io/documentation/oo_user_guide.html#action-hooks[Customize your OpenShift build process with "Action Hooks"] 

[[markers]]
=== Marker Files
Marker files can also be used to control various hosting options.  Adding empty files to `.openshift/markers` will have the following effects:

[cols="1,3",options="header"]
|===
|Marker |Effect

|hot_deploy
|Disable app restarting during git pushes (see 'Development Mode')
|use_npm
|This will force to run your application using NPM instead of using 'supervisor'
|===

[NOTE]
====
The `hot_deploy` marker is restricted to the supervisor only. Using the
`use_npm` marker, your application will always do a full restart.
====

== Local Development

[[run]]
=== Starting your application

npm install

npm start

=== Managing Dependencies

npm install --save

[NOTE]
====
On OpenShift, module dependencies that usually need to be installed using the `-g` or `--global` flag (in order to become available on the command line) will automatically be added to the `PATH` as long as they are documented in the `dependencies` or `devDependencies` section of the project's `package.json` file.
====

[[env-vars]]
== Environment Variables
The Node.JS cartridge uses environment variables to interact with your application:

OPENSHIFT_NODEJS_IP:: Bind to this IP address in order to recieve traffic from the routing layer
OPENSHIFT_NODEJS_PORT:: When on OpenShift, listen on this port
OPENSHIFT_NODEJS_POLL_INTERVAL:: This integer value may be set as an environment variable (default is 1 second)
NPM_CONFIG_PRODUCTION:: OpenShift will not install `devDependencies` link:http://stackoverflow.com/a/23749201/754025[when `NPM_CONFIG_PRODUCTION` is set to "true"]

link:#top[Back to top]

== What's Next?
 * Learn how easy it is to set up Domain Names and SSL
 * Make sure your Nodejs application will run on OpenShift, in just two simple steps!
